#!/bin/bash

# Simple Nostr Note Writer
# A convenient wrapper for writing kind 1 notes to test relays

# Colors for output
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Function to show usage
show_usage() {
    echo -e "${BLUE}Simple Nostr Note Writer${NC}"
    echo ""
    echo "Usage: $0 \"Your note content here\" [--dry-run]"
    echo ""
    echo "Examples:"
    echo "  $0 \"Hello, Nostr!\""
    echo "  $0 \"Testing my Nostrbots setup\""
    echo "  $0 \"This is a longer note\" --dry-run"
    echo ""
    echo "Options:"
    echo "  --dry-run    Test the note without actually publishing"
    echo ""
    echo "The script will publish to test relays configured in src/relays.yml"
}

# Check if help is requested
if [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
    show_usage
    exit 0
fi

# Check if content was provided
if [ $# -lt 1 ]; then
    echo -e "${RED}Error: No note content provided${NC}"
    echo ""
    show_usage
    exit 1
fi

# Check if .env file exists
if [ ! -f ".env" ]; then
    echo -e "${YELLOW}Warning: .env file not found${NC}"
    echo "You may need to run the local development setup first:"
    echo "  ./setup-local-dev.sh"
    echo ""
fi

# Run the PHP script
echo -e "${GREEN}ðŸš€ Writing Nostr note...${NC}"
php write-note.php "$@"
