import java.text.SimpleDateFormat

// Get the calendar date-time for Berlin time zone
def timeStamp = Calendar.getInstance().getTime().format('YYYY:MM:dd:hh:mm:ss',TimeZone.getTimeZone('CET'))
println "Timestamp is: ${timeStamp}"
env.BUILD_TIMESTAMP = timeStamp

// Extract current day
def thisWeekday = env.BUILD_TIMESTAMP
thisWeekday = thisWeekday .split(":")
thisWeekday = thisWeekday [3]
println "Timestamp day is ${thisWeekday}"

// Extract current hour
def thisHour = env.BUILD_TIMESTAMP
thisHour = thisHour .split(":")
thisHour = thisHour [4]
println "Timestamp day is ${thisHour}"

pipeline 
{
    agent any
    
    stages {
    
        stage('check system') {
            steps {
                    // do something
                    // check to make sure nsecs are stored in environment variables and return the relevant npubs
                    // check to make sure that all target relays are running
                    echo "system check PASS"
                }
        }

        stage('finance bot') {
            when 
                {
                    // Note: You can change condition as per your need
                    // Stage will run only when the day is Mon 
                    expression {
                        thisWeekday == "Mon"
                    }
                }
            steps {
                    // post some financial data
                    echo thisWeekday
                }
        }

        stage('catholic morning bot') {
            when 
                {
                    // Note: You can change condition as per your need
                    // Stage will run only when the hour is 5 am 
                    expression {
                        thisHour == "05"
                    }
                }
            steps {
                    // post morning readings
                    echo thisHour
                }
        }

        stage('catholic evening bot') {
            when 
                {
                    // Note: You can change condition as per your need
                    // Stage will run only when the hour is 5 pm
                    expression {
                        thisHour == "17"
                    }
                }
            steps {
                    // post evening readings
                    echo thisHour
                }
        }
    }
}